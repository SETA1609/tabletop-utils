{% load bootstrap5 %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Initiative Tracker</title>
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>  <!-- HTMX CDN -->
    <link id="theme-link" rel="stylesheet" href="/static/css/light.css">  <!-- Default light theme; we'll create CSS files -->
</head>
<body class="{% if request.session.theme == 'dark' %}bg-dark text-light{% else %}bg-light text-dark{% endif %}">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="{% url 'home' %}">Initiative Tracker</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <select id="language-selector" class="form-select">
                            <option value="en" {% if request.LANGUAGE_CODE == 'en' %}selected{% endif %}>English</option>
                            <option value="es" {% if request.LANGUAGE_CODE == 'es' %}selected{% endif %}>Espa√±ol</option>
                            <!-- Add more languages -->
                        </select>
                    </li>
                    <li class="nav-item">
                        <select id="theme-selector" class="form-select ms-2">
                            <option value="light" {% if request.session.theme != 'dark' %}selected{% endif %}>Light</option>
                            <option value="dark" {% if request.session.theme == 'dark' %}selected{% endif %}>Dark</option>
                        </select>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'initiative' %}">Tracker</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        {% block content %}{% endblock %}
    </div>
    <script>
        // Theme switcher (stores in session via AJAX, but for simplicity, we'll use HTMX POST)
        document.getElementById('theme-selector').addEventListener('change', function() {
            htmx.ajax('POST', '/set-theme/', {values: {theme: this.value}, target: 'body', swap: 'outerHTML'});
        });
        // Language switcher (similar, but Django i18n uses URL prefixes or cookies; here simulate with POST)
        document.getElementById('language-selector').addEventListener('change', function() {
            htmx.ajax('POST', '/i18n/setlang/', {values: {language: this.value}, target: 'body', swap: 'outerHTML'});
        });
    </script>
</body>
</html>
